Author: IOhannes m zm√∂lnig
Description: flush buffers when writing files to disk, in order to properly
detect whether a file has been successfully written (catches some remaining
problems reported by #203288)
Forward: http://sourceforge.net/tracker/?func=detail&aid=3303222&group_id=55736&atid=478072
--- puredata.orig/src/m_binbuf.c
+++ puredata/src/m_binbuf.c
@@ -917,6 +917,13 @@
         sys_unixerror(fbuf);
         goto fail;
     }
+
+    if (fflush(f) != 0) 
+    {
+        sys_unixerror(fbuf);
+        goto fail;
+    }
+
     if (deleteit)
         binbuf_free(x);
     fclose(f);
